<div class="loading-spinner" *ngIf="settings === null">
    <mat-progress-spinner mode="indeterminate"></mat-progress-spinner>
</div>
<div *ngIf="settings !== null">
    <button (click)="saveSettings()" mat-fab color="accent" class="mat-fab mat-fab-bottom-right">Save</button>
    <form *ngIf="settings.SMSGlobal != null">
        <mat-card class="exchange-card card">
            <mat-card-header>
                <mat-card-title>SMS Global Settings</mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <table cellspacing="0">
                    <tr>
                        <td>
                            <mat-checkbox name="smsEnabled" [(ngModel)]="settings.SMSGlobal.Enabled">Enabled</mat-checkbox>
                        </td>
                    </tr>
                </table>
                <mat-grid-list cols="2" rowHeight="3:1">
                    <mat-grid-tile>
                        <mat-form-field>
                            <input matInput name="smsUsername" [(ngModel)]="settings.SMSGlobal.Username" [disabled]="!settings?.SMSGlobal.Enabled" placeholder="Username">
                        </mat-form-field>
                    </mat-grid-tile>
                    <mat-grid-tile>
                        <mat-form-field>
                            <input matInput name="smsPassword" [(ngModel)]="settings.SMSGlobal.Password" [disabled]="!settings?.SMSGlobal.Enabled" placeholder="Password">
                        </mat-form-field>
                    </mat-grid-tile>
                </mat-grid-list>
                <mat-grid-list cols="3" rowHeight="2:1" *ngFor="let contact of settings.SMSGlobal?.Contacts">
                    <mat-grid-tile>
                        <mat-checkbox name="contactEnabled" [disabled]="!settings?.SMSGlobal.Enabled" [(ngModel)]="contact.Enabled">Enabled</mat-checkbox>
                    </mat-grid-tile>
                    <mat-grid-tile>
                        <mat-form-field>
                            <input matInput name="contactUsername" [(ngModel)]="contact.Name" [disabled]="!settings.SMSGlobal.Enabled || !contact.Enabled" placeholder="Contact Name">
                        </mat-form-field>
                    </mat-grid-tile>
                    <mat-grid-tile>
                        <mat-form-field>
                            <input matInput name="contactPassword" [(ngModel)]="contact.Number" [disabled]="!settings.SMSGlobal.Enabled || !contact.Enabled" placeholder="Contact Number">
                        </mat-form-field>
                    </mat-grid-tile>
                </mat-grid-list>
            </mat-card-content>
        </mat-card>
    </form>

    <form *ngFor="let exchange of settings?.Exchanges">
        <mat-card class="exchange-card card">
            <mat-card-header>
                <mat-card-title>{{exchange.Name}} Exchange Settings</mat-card-title>
            </mat-card-header>
            <mat-card-content>
                <table cellspacing="0">
                    <tr>
                        <td>
                            <mat-checkbox name="exchangeEnabled" [(ngModel)]="exchange.Enabled">Enabled</mat-checkbox>
                        </td>
                    </tr>
                </table>
                <mat-grid-list cols="3" rowHeight="2:1">
                    <mat-grid-tile>
                        <mat-form-field>
                            <input matInput name="apiKey" [(ngModel)]="exchange.APIKey" [disabled]="!exchange.Enabled" placeholder="Exchange API Key">
                        </mat-form-field>
                    </mat-grid-tile>
                    <mat-grid-tile>
                        <mat-form-field>
                            <input matInput name="apiSecretKey" [(ngModel)]="exchange.APISecret" [disabled]="!exchange.Enabled" placeholder="Exchange API Secret Key">
                        </mat-form-field>
                    </mat-grid-tile>
                    <mat-grid-tile>
                        <mat-form-field>
                            <input matInput name="apiClientId" [(ngModel)]="exchange.ClientID" [disabled]="!exchange.Enabled" placeholder="Exchange API ClientID (optional)">
                        </mat-form-field>
                    </mat-grid-tile>
                </mat-grid-list>

                <label>Enabled Currencies</label>

                <mat-grid-list cols="6" rowHeight="2:1">
                    <mat-grid-tile *ngFor="let currency of exchange.AvailablePairs.split(',')">
                        <mat-checkbox name="availableCurrency" [disabled]="true || !exchange.Enabled">{{currency}}</mat-checkbox>
                    </mat-grid-tile>
                </mat-grid-list>
            </mat-card-content>
        </mat-card>
    </form>


</div>